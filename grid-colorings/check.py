#!/usr/bin/env python
import os, sys

# chromatic polynomials for n=3..10 from http://www.hs-mittweida.de/~peter/research/grids.html
CP = {
    3: lambda x: 79*x-323*x**2+594*x**3-648*x**4+459*x**5-216*x**6+66*x**7-12*x**8+1*x**9,
    4: lambda x: -17493*x+112275*x**2-346274*x**3+682349*x**4-960627*x**5+1022204*x**6-848056*x**7+557782*x**8-292883*x**9+122662*x**10-40614*x**11+10437*x**12-2015*x**13+276*x**14-24*x**15+1*x**16,
    5: lambda x: 32126211*x-290435775*x**2+1292190143*x**3-3767970906*x**4+8082227271*x**5-13560791041*x**6+18473119556*x**7-20932275014*x**8+20054961996*x**9-16429209737*x**10+11594826096*x**11-7082871652*x**12+3754018486*x**13-1726958903*x**14+688444232*x**15-236955938*x**16+69997383*x**17-17590911*x**18+3714180*x**19-647352*x**20+90798*x**21-9864*x**22+780*x**23-40*x**24+1*x**25,
    6: lambda x: -486300871185*x+5825814032243*x**2-34701118575475*x**3+136941429389741*x**4-402341997408799*x**5+937366494881708*x**6-1800744848216564*x**7+2928391022625810*x**8-4106892530565262*x**9+5035286921842561*x**10-5452617664392448*x**11+5255806080178105*x**12-4536473593633301*x**13+3522243070378354*x**14-2468460778341254*x**15+1565357403345916*x**16-899710667370661*x**17+469138441850555*x**18-221984387672138*x**19+95279523237139*x**20-37057990954938*x**21+13038370427571*x**22-4139593962920*x**23+1182113898251*x**24-302331982014*x**25+68878826042*x**26-13883355652*x**27+2454371695*x**28-376347854*x**29+49332660*x**30-5421612*x**31+486210*x**32-34195*x**33+1770*x**34-60*x**35+1*x**36,
    7: lambda x: 60466776520638151*x-922154302362866569*x**2+7025664984910421341*x**3-35641918028267568371*x**4+135369215825036731177*x**5-410250705513629800783*x**6+1032451012296991972867*x**7-2216960500804578752422*x**8+4141697227066979584712*x**9-6830530217372810189624*x**10+10056541931639164603607*x**11-13334646797326075179058*x**12+16036290758482683498688*x**13-17590653016736281101094*x**14+17681773699830438464325*x**15-16348665822385814798376*x**16+13947697552939503415693*x**17-11007588075825516394630*x**18+8052847847428403113202*x**19-5470083215526714490040*x**20+3454521587982666078590*x**21-2030267506558332837891*x**22+1111177466299328848403*x**23-566568113071643821648*x**24+269165350824419182148*x**25-119133381750252738955*x**26+49105932301716479533*x**27-18838563798680068882*x**28+6720264457198789127*x**29-2226581959125468535*x**30+684166468013185562*x**31-194611137853887936*x**32+51133582658290835*x**33-12377772493912959*x**34+2751868417954614*x**35-559835789575554*x**36+103761863635925*x**37-17429512454108*x**38+2636742581430*x**39-356501190440*x**40+42674658178*x**41-4469520251*x**42+403410654*x**43-30755376*x**44+1926585*x**45-95248*x**46+3486*x**47-84*x**48+1*x**49,
    8: lambda x: -61628919031422759531861*x+1162422642485040133911057*x**2-10977870644947255434030039*x**3+69200313992915419997643460*x**4-327451611397554856936477453*x**5+1240147442805856813254373128*x**6-3913658669898832868532751919*x**7+10579005883188306091163266436*x**8-24987489389710991672852512242*x**9+52353413915274842211730397617*x**10-98442397665974346068552727965*x**11+167673337195700595113851909069*x**12-260647006093047701373312120342*x**13+372073205396468803348524481416*x**14-490251610006851255009562160185*x**15+598818031641953590899875988447*x**16-680515333612366500612271866398*x**17+721762615044307979815575348123*x**18-716332893424299530153322189548*x**19+666784795991402058851348162011*x**20-583247870382302786331037788587*x**21+480223419215963226560680272690*x**22-372715484102384013171394001823*x**23+273013689888408498822153889953*x**24-188934439806828243829346584129*x**25+123631868637605411817518729397*x**26-76550473919621959262483744047*x**27+44875263214174189383418320147*x**28-24916872437140185840555290277*x**29+13108066319526440539843133031*x**30-6534636295783063592887196373*x**31+3087241845614663868050877487*x**32-1382183706019679679973976291*x**33+586323532036293891752505628*x**34-235595388763491771011871024*x**35+89636670692693565778203217*x**36-32275601124439602383743108*x**37+10991561880071116172895827*x**38-3537621546674051110489260*x**39+1075079761635693913196953*x**40-308172042121843984243945*x**41+83223240704544535835165*x**42-21144294054988529383216*x**43+5046049168793594268422*x**44-1129108769847803637898*x**45+236403188594842578740*x**46-46204737127258694328*x**47+8407622850755359065*x**48-1419980561998570628*x**49+221810896558314369*x**50-31915642806166084*x**51+4209996923280562*x**52-506284148356142*x**53+55139795039900*x**54-5395563919520*x**55+469773018459*x**56-35955415833*x**57+2382122274*x**58-133865298*x**59+6205479*x**60-227871*x**61+6216*x**62-112*x**63+1*x**64,
    9: lambda x: 514169895039181006013272826999*x-11732887795636164598700970251661*x**2+134192221942589587226027639267899*x**3-1025592876155746285734665335470663*x**4+5891500786803871505076153488444297*x**5-27127035192244097691237894785106657*x**6+104255454368996067082896820268043000*x**7-343868459159669887285216334150478123*x**8+993255928683928258256002749650801661*x**9-2551246246708723299212995215848651685*x**10+5897342106639233795950594517850656696*x**11-12385784780337403931820182009480186671*x**12+23819720359790197933615624023295660851*x**13-42217789300848508953779153312984702458*x**14+69334144939508285991371183626118840039*x**15-105993819780142237131678799837899033332*x**16+151424508919583313527235020886927726343*x**17-202842641964595365367580966333931103399*x**18+255529145132425836859746003325840676974*x**19-303492309938184850913057930072653152663*x**20+340605407506901142480098724955191536754*x**21-361913932797803246063705934638925918551*x**22+364721566373657593178859658580313838484*x**23-349128190337682471284598164137274995211*x**24+317880691144503861120041264986298247352*x**25-275625967736172106912481417705217460711*x**26+227831621074230544312619206829146993687*x**27-179702189528110111377828753072543660315*x**28+135362279573555946542310941931145740804*x**29-97445681023591333482195252597858625178*x**30+67084778538295487117746810915985839182*x**31-44189690290283247406538691684836116171*x**32+27864972116791439875861490099700886694*x**33-16827141708059703815671070114394115747*x**34+9734636967504424857775932260693057224*x**35-5396375869328150040843778464188341783*x**36+2867121302400694229214716573998865847*x**37-1460205272360734681365272891132656260*x**38+712923872601202774727584625330738818*x**39-333692718395345598960659534792224834*x**40+149731589534206832609655170860027608*x**41-64403304083994080338350191237833524*x**42+26550445837524747162517608613810052*x**43-10488690711256425917167785808729660*x**44+3969619505200950721796109921499735*x**45-1438871196687330195667932971406179*x**46+499323336940561065090673097233466*x**47-165822467781176443272664786677078*x**48+52673608229893461947650258170645*x**49-15995140239914306155477509944659*x**50+4640386314887494676519691446306*x**51-1285238592411055697079333450702*x**52+339573274043829573819863839949*x**53-85510850125700621478412716576*x**54+20503247769842993348480002132*x**55-4675924180303188626601490266*x**56+1013058528671913701836270639*x**57-208231574456083835519463980*x**58+40547455077879410221887547*x**59-7467499920730999823783154*x**60+1298349333084534478734439*x**61-212682696697941759981426*x**62+32750107071202574416872*x**63-4728559382544399719880*x**64+638316382065378232465*x**65-80301667321303244068*x**66+9379690417955639316*x**67-1012943316983027296*x**68+100642886583074242*x**69-9147308719925929*x**70+755398939256056*x**71-56222946516654*x**72+3734431521712*x**73-218674003967*x**74+11114098408*x**75-480376848*x**76+17169852*x**77-487280*x**78+10296*x**79-144*x**80+1*x**81,
    10: lambda x: -35080317322412559931041187525714382193*x+951633462751765716705992323127286211659*x**2-12944405406380926411886910616676992847689*x**3+117713132890009773389082905156262057797374*x**4-805032253133314159857431607397435155588215*x**5+4415885420177350416231716581970284582161512*x**6-20234409507958558805201700063866910112564856*x**7+79647626641830738141133378424513382813707753*x**8-274860376481802219964061018386833304485685350*x**9+844555460023219326811633013706232575495687138*x**10-2338761585081530933339924609934206792426777152*x**11+5894020793981409260284693960464239474276754224*x**12-13625857525659803312751179774863023093666293043*x**13+29088264253750367701579332765617783672980257412*x**14-57662775305969059308416533628107841556782948928*x**15+106649752730019787661689653155251723235777205022*x**16-184792475894280636599689444003363526777855420483*x**17+301027462558093864877676518588864931422202077955*x**18-462452658732208790660775222245299017797563309657*x**19+671809902361608686640948149668001704100443888211*x**20-925090607137297930657027835519617706403956399214*x**21+1210052785781163204600745120557742723913885040796*x**22-1506361526631897909137961045541552681981215022347*x**23+1787699580040281749368631503832463555569806516727*x**24-2025629504967742791802632902456510877832884692787*x**25+2194415805929114212098970167988150926537418723072*x**26-2275652633997153988379370989368451629077307896603*x**27+2261538251778625516137165233456914821793849611773*x**28-2156002820783356720941937907609012719572935443474*x**29+1973500130375111170529532706440130622339766104179*x**30-1735901682316879481913212128224861086854013470108*x**31+1468375405208121353410434610961572103238901882950*x**32-1195270603545501674442808485743253268528605281342*x**33+936866256541200694950998067626855261339220232902*x**34-707473956108570954598476785208681480495283206024*x**35+514968090470575781277327329931489114963483911044*x**36-361476984016706555545067962984298841908164369044*x**37+244784775334712831178913990090989852235703377320*x**38-159972504419510616034326354794207609534250548760*x**39+100925104502289925547292661943181992657131388170*x**40-61484366434788943137798940465499506590948615137*x**41+36177985339029546512614606598034647051871660807*x**42-20564842235642409114126149261338870883362928764*x**43+11294840348161956478734317206761610386775957913*x**44-5994689419858341572807446286449089661047135078*x**45+3074889822142891741123009675498405202114398366*x**46-1524402756050620548927074778581281879372096065*x**47+730457759394084501736933512624583929780141018*x**48-338314609153512984970907550178962045359140859*x**49+151449899742700744591187890040769735024327170*x**50-65526884150895036573952558912794868388481396*x**51+27399296785466521275641621996529987529183932*x**52-11070904712325969209991568551464020781505813*x**53+4322074653170007807023862737600360630826857*x**54-1630029956627616351018257624983201150942733*x**55+593756818125982801548898044097900673065118*x**56-208849465943899896395415147125269194006087*x**57+70918250718649258217578725510670058207438*x**58-23241082378880724327800620380695753801648*x**59+7348306863975440636333914503999932526864*x**60-2240754065559459930034087227614089277708*x**61+658725057948983302292033782403226119058*x**62-186606707889590285776025127162266082192*x**63+50916120689864148340397945867697685001*x**64-13373992881230364743651266074647024374*x**65+3379845890150713951052873286129186073*x**66-821283684352456482855999920326045987*x**67+191759535913726174894361576108759622*x**68-42990244338878303075750720777505278*x**69+9246690557245144853961591581612337*x**70-1906473270252156654633458379943160*x**71+376439433364771297529167936831549*x**72-71110848132840783985356478040555*x**73+12837193049131686668245565397770*x**74-2211930290531142829956948912946*x**75+363299970429446537988982235561*x**76-56796731170149186648996960067*x**77+8438326122099239949715704043*x**78-1189342131001446913796674718*x**79+158722937860034831360562137*x**80-20013867025442099537292730*x**81+2378781348534672103811149*x**82-265806369083544958359102*x**83+27840689151592112900893*x**84-2724274981421913189258*x**85+248105050661436987959*x**86-20938993233034917548*x**87+1629467237380525029*x**88-116247218469663463*x**89+7550824624007956*x**90-442925392063912*x**91+23231616287050*x**92-1076213575196*x**93+43351126440*x**94-1487585880*x**95+42282468*x**96-955779*x**97+16110*x**98-180*x**99+1*x**100,
    11: lambda x: 19559164481382617249118386379562035209011782667*x-621774741077508361917221548047764821516608101647*x**2+9912109358248448077129732939256659290384860096943*x**3-105654221213044390569546929511391575505335888849525*x**4+847094800596285697773189314673089951775453648488484*x**5-5448797815898955804698356852604981133571173266070968*x**6+29287301375086249123458723182416439450066516715277933*x**7-135284659073805840572405433874431818751834511584725101*x**8+548149094147271030248002356362324129837999404935149045*x**9-1978770407760864593816491949950302320161983821414802431*x**10+6442457690482284220615772208826225618916043664946572249*x**11-19104806332189816510663213009987299495381995906403667043*x**12+52020811213621517089111840004713823669555875297905357281*x**13-130942486273922211437174231525524308893080971682739058708*x**14+306425675500920370199783376240002444753305077141855878906*x**15-669920673002835764587004577272744591440231579303741312236*x**16+1374035533796324768765456290286971273253531111634192593144*x**17-2653594945727610952055813790500379481143644513649622369482*x**18+4840865071883058561854295317231756447746793978500332902765*x**19-8365434709781277611026286272531883216761890546955178615199*x**20+13728344042847066501988188679038000647486345330324028965313*x**21-21442762898452002799310657553086476546782245659829934578174*x**22+31940650934737676056908022698673494249582744905541357224237*x**23-45455565129888791050006788765091856230192934379739258456452*x**24+61903362705466931391536148641244432059961365423929661274227*x**25-80790847775765822219959748014928202472106085831024434452401*x**26+101183328616915797481851940571842892938395241998210851352499*x**27-121753317326342404980982634587462472142083386735431579345829*x**28+140915145961927150926142751441075182556664172440756430262402*x**29-157028443630952331757275709051007755664310955557408900289853*x**30+168633759831959095379984618569916269529758132047600848801820*x**31-174672577539864788525093311717727558942804939749184634294703*x**32+174645460133991147102994168085237842073456742209636370629649*x**33-168675992571483999719344078144404127903947549382459647369333*x**34+157470353184696788198635377075217993146171094338492390851826*x**35-142186147706513058265705737093249654144895873258444515226609*x**36+124242813091344797048816708204064620259140480967048356529901*x**37-105114857797058413939449085738859045294159648906977277003452*x**38+86147244509857867114641456669906128839625650968420644184523*x**39-68421455595200496374320708579279772213527502494815062312439*x**40+52685459854533275441959642371095397679370313082051432640520*x**41-39345626299569774173943812009317776977987263312076999312049*x**42+28507276363158674849120969238143142531644522605214462562872*x**43-20044831839197496338332750312545071917310980714786754202219*x**44+13682284546684280105560423774469958865290366539907123368682*x**45-9068496547288390926674458213545573394298781476419497124056*x**46+5837580274452044525884630183900515659281308530864988271221*x**47-3650410865556545434309064726888286126484449603135085268219*x**48+2217904250869060224251032748373617735478546385303688000831*x**49-1309506648030209395567394811547433246394479595305422425452*x**50+751448835622161576133206264438121068693343039288683180790*x**51-419152807990050990333865220777505419113502789933019355689*x**52+227286101388764962440858793229311317559342833664225106963*x**53-119822742315615987470316345988641641325026411253564190943*x**54+61418911924474997725341247424413360614220725385421840050*x**55-30611494322076887833597338842111087875449124516538715112*x**56+14835498637832749307502627112077678657642316644383771193*x**57-6991387002423537310629694704340150749934962344837603964*x**58+3203828743541015229020796074121898919218764909465811246*x**59-1427624689524862099730410829914432101593312515288822310*x**60+618563905543559398468076324869538950240876041293806698*x**61-260591804671802082832236438927350778886985510355824897*x**62+106737097604020381906325801797498852033971033650012677*x**63-42502469406100034735502038581003967520467365227370641*x**64+16451881656606723541312496911301945797034338412731024*x**65-6189718013592871429533070190855302123133924783924816*x**66+2263204940966503016575487123629822106439220686705982*x**67-804101686998653359702158917556673857762315369396515*x**68+277562503571651314847653513110510533057778753241360*x**69-93066661443574817190085720669903468481968504797857*x**70+30305654791445535517201613832270279621940280354205*x**71-9581946259322668190841375638259736419219176290092*x**72+2940898147642973495960776901069602336906569567728*x**73-875969778658845416133981726615955111641498395207*x**74+253138668194884993916861403898816991582760173495*x**75-70950533744233419177715540015109631481232710423*x**76+19281375294741816754572904534518972889217092305*x**77-5078695034518996882199359610651582324139916833*x**78+1296084643118712530242834042515939899627773514*x**79-320335503532918817861253149287156778612404282*x**80+76643971869744745712844023314699343816860134*x**81-17743915513674121356428741326539609322858566*x**82+3972852762911973604518182308867855829532708*x**83-859814548827239184774200974251111873710726*x**84+179766117202843179631017604883698038531816*x**85-36286534118520076598457144682710820535478*x**86+7066961411286721151799202985821248990508*x**87-1326979159564882716946376025998358048870*x**88+240055742760579769647883310262315911903*x**89-41804704067198029844775355926966309603*x**90+7002054940305623042704291008743132547*x**91-1126955549555080252885493285102959268*x**92+174112973639967884162426220752550847*x**93-25794438385479277240722650017355482*x**94+3659997903332948608778067095028549*x**95-496754832492503933350799563583962*x**96+64403449577464449663222359711077*x**97-7963941410504513672352109791740*x**98+937745971024771669916553984375*x**99-104954056467243348768066092954*x**100+11143246712914934970397609906*x**101-1119892110146799212959076919*x**102+106278226485204264207170980*x**103-9498384970124693150885712*x**104+797054547536194775432547*x**105-62588031621626959466114*x**106+4581385694184854017800*x**107-311248295269617947110*x**108+19527048789772760554*x**109-1124719934772230534*x**110+59066281884526092*x**111-2805134480320752*x**112+119277068722785*x**113-4485278179539*x**114+146840645610*x**115-4100221944*x**116+94945095*x**117-1750440*x**118+24090*x**119-220*x**120+1*x**121,
    12: lambda x: -89071392649865065957471571526136601997871108359454880013*x+3278541499012241058206603684944078719287828738234692073409*x**2-60512711110766364813637489353485746188289755342580821293045*x**3+746759901326961800089725181799845593241010567226967524729500*x**4-6931590550429293397126988000459738867270981522941105890172054*x**5+51620044333556423062709481205026295685854171009191346449125681*x**6-321251161220502399352226794861195387276280160343302206540890917*x**7+1718369852752340681490005998499638704245120876086755808125256346*x**8-8064020826329049700034523665530188538064658698034318992287669922*x**9+33724431751432930698921097943735182127762575125824124047863041257*x**10-127244705350797509812876509420703539689048259196907773861264862603*x**11+437466564424329052593660260094847976414778958010926300234106749965*x**12-1381662995241192314761242626308985632764237177542234747517239575372*x**13+4036186492357000902255834258658933938076499273471546833058630167170*x**14-10968791151937212582172390853576229516964894469724307240420971096044*x**15+27868388762279468534911428263323189944894077946393156107589424155381*x**16-66479481436946937857029554720198076484089575312749878126522830851410*x**17+149453438782872518307913340430021394994366509327082804011386091191292*x**18-317680122557367884143084439017599246786460362393920180911636440433141*x**19+640322471473240643955864862341475943262532709566948594191579253092294*x**20-1227019893140256046941920014070405929278620275553810915721032874155999*x**21+2240523811109843631885559346212518023809368054086943320778643817518591*x**22-3906534097431391733853054107180913660671451817857228622925232063747782*x**23+6516112401247976299106720488671529163244172421797004292233186145027665*x**24-10415363098284705000820735286334845128917706194658921612857006275589419*x**25+15977761362178225546847600744983458759574007501915309347600530632326268*x**26-23557038552976766060370566622576712836443940882618312425452474847544867*x**27+33422884050252831004481772628759976972651813463548484923422820644729468*x**28-45687175901123762750899470162777622362048719348744642494040239171044522*x**29+60233630478947538950522406377360828088585308351731263545304512367879427*x**30-76666930581776938732837992649762816926937883241586601437431335556321620*x**31+94297013626951736358511856916050569751254289379040767594685547921620404*x**32-112169542865992847995234136785959169601821319883662906673560206405110003*x**33+129145145472253337934525334522140610529868642608347112273640449125933186*x**34-144019559586690498957142110438181275288322132568286429128555355690490029*x**35+155667022368799701886678783079494453789012644683055942842524017575693864*x**36-163182769318360786348487734894066755197266750083068363288942965032391155*x**37+165999333304535976649885596525287738916917150479686401677984032386712776*x**38-163955932611821400365938263929272296709411375437317842484791299834764655*x**39+157309512663713718774461090250434018651998906340131880587955392467765744*x**40-146687582140503165999960548313341918960561721574727973732566618764561815*x**41+132993962443264738979202334578761281999339504401887963076551406913784607*x**42-117286392394812382992000745683212622563534137524601303276567928023944352*x**43+100648075301578033322303110768897416112148711701045679124842116234368218*x**44-84073548158627300257434402164102870658081216418010636649992404001494393*x**45+68383741367161689668924213040048633909092989768465892686950188623520009*x**46-54177592440680810337599553274986999775003460125452544037057485431028826*x**47+41820048843179245652502437523424102238472286452928447087401639825747214*x**48-31460336472559961212222221775592712134896124348426482576770961367560311*x**49+23070873868121298156010670483804600286093361814053447237944713405850237*x**50-16496307196827667322156028840320986421797775240239133462229781972704071*x**51+11503348592101345844266580591524442759232160151463714171954968710110109*x**52-7824607775589915008730114785242918539407273144734300268781477601856508*x**53+5192552537720889175800942863136931642523678215916299796206717010885311*x**54-3362421851513976975915875312422065394860879290891013943123103502255750*x**55+2124923864989775520946099004257925517566588873153748399667141748571377*x**56-1310736857437734935730174697305418087427925738786996896496665007910181*x**57+789267306682966005530838372798207448352826596104443651563825118208321*x**58-464001403915239607310157482651204042585384943481090247354731037225853*x**59+266345868324365945984802664492921243926368516267056070653236057353145*x**60-149294562303948195976120604913606149311699887151592475762943724030746*x**61+81723760549512313093409914736392563279576630615457208324839257476644*x**62-43690722576402428263404454056736123688039696259529390493483227104988*x**63+22813514647403432515036517353458238998094484276615985364002726957858*x**64-11635318023918642362357370378093945773841837660032725526528791784334*x**65+5796474784309852276979239453646357116379792672364640580495322090224*x**66-2820729444472405820748863720246534333337040167537264174381047964829*x**67+1340844867891625684405798403216487685319441977192102907284553694489*x**68-622613908836166064085072674479243349309230574679796088314857765012*x**69+282411004006516668578944200589864253133855603111663517296695567786*x**70-125130174906660594835829439399669255437628882096603879780763681681*x**71+54156560477062609699680384396570622661059621126493271987409995206*x**72-22894726151787209716847796777156709798856173207470438748578833707*x**73+9453612194883430305096357237593812082142012501404859251081998493*x**74-3812558074625780890385095501329709073273496831512039060670800993*x**75+1501639561461068685700420253430276427357953151475871639242771661*x**76-577584369660209148572546373334648562379831182063150860040149953*x**77+216935845562192858227520151478753162140945695956027292788900912*x**78-79556318624349800099730136497976551057282730439000882123705511*x**79+28484094513405788738518182541628303519276839698230769218256175*x**80-9955589016781418499165115593230069473208287934004537521245429*x**81+3396379034413596062271581605087490787239225293615563175430912*x**82-1130819176689942467123814610395209440828612789774712041782897*x**83+367397657763542948459852473565058335502471240206957679232940*x**84-116460667139143799958222944228546727922491157593161685121485*x**85+36012249010535282175392630293214583187190145443023600305398*x**86-10861066921462550965615846705084031022129776876550026636529*x**87+3194212577145264215574118998067908220777411760989796711015*x**88-915875517768622081987999734361921348704113565743086007992*x**89+255974578074519148378034779163344898580395951183674575038*x**90-69718077041510242534128018524314890958805362164491816372*x**91+18500194950473863668976642199112595460192620183240943813*x**92-4781643296900565590726497221192681520301154177246241504*x**93+1203452072174876604769692485729878234720371138999904613*x**94-294852491205742813323033922693197462487422422359469472*x**95+70302584158718417187063680061094237086159296369882142*x**96-16307465171986742660041823037702321970610273855781598*x**97+3678749176684684911687966755016029344150510195227995*x**98-806776999754955189396772237983590992840262076000929*x**99+171940508511868054091238510288892928902111914469079*x**100-35595587053711190340517230557343137039232812536484*x**101+7155150493292281190331986154817308368897305851102*x**102-1395874244326126975657306844533416506011851839752*x**103+264160011213447895468694060212432543237273168449*x**104-48468183891811791010569517027589986261860943661*x**105+8617421264718402747254541173726168154248931990*x**106-1483802832233340630956369356003310014497390391*x**107+247277738116460771922545248597026372961282974*x**108-39858273766392310554896776524038201364613073*x**109+6209733196862863630042922771352926899528522*x**110-934382829258621829885310802083123994444905*x**111+135684133689995371260168691331428449807277*x**112-18998394479844643787701770549478793247962*x**113+2562677324407333152561352006279401764420*x**114-332688277706831345661919151321411803978*x**115+41523499204609329271484777501229481213*x**116-4977088260288404296043393396287249078*x**117+572210520494784623697154443812524789*x**118-63018404388597457834391495994488652*x**119+6638881489304640064190854917235345*x**120-667990755187710322129412319507836*x**121+64086504232052527051789335574666*x**122-5851786742729444523162652889386*x**123+507533381468120179885912554583*x**124-41719149340424818175037855229*x**125+3242201935597469175023881450*x**126-237574429508727743807971344*x**127+16364305330150637117720105*x**128-1055975511837121662840257*x**129+63590762634663874160299*x**130-3558022985593586398322*x**131+184035443538294823591*x**132-8748217025655485597*x**133+379543130735028516*x**134-14905500876511000*x**135+524608578151756*x**136-16343939481407*x**137+443706007998*x**138-10283009022*x**139+197797545*x**140-3031743*x**141+34716*x**142-264*x**143+1*x**144,
    13: lambda x: 3311701125295352833506629737101704443026611285159633384550008660359*x-139703989127322627150161567078602001216885689219358525909823294500061*x**2+2954801850930409133765464844369362437427827068550193332289335591221839*x**3-41779061574703775965657295833008445071155940036062567878517675177710663*x**4+444279125845759621045372365227311161934131611215922375520927670080863007*x**5-3790059704867536718055962209174014000840944842992926921955271914130174060*x**6+27017740779917614024310507885509090899792423087806622796336373119366295175*x**7-165532997370285627429382425151647055951221737232768406935493356177899331518*x**8+889789382781681457456391968163178412347207523295526698496523813354143317592*x**9-4262562556785169093603296766761345625058788599420574684255845794431819164325*x**10+18424668325504473851919248218783935842870585172839379552855800079434347528107*x**11-72577762436344273116355867445910376764019385228479363097385041471324257190516*x**12+262692169647830150978271542193063310668683501981528059481816977481505830692523*x**13-879657148884030622304659396377493389753886670443177355943363090574541201192352*x**14+2741151412677572682651550382030142010682740094515887756219787296929196606702725*x**15-7988721165310842724180969919969306342782095110842372211183581164570476741847361*x**16+21868938923823793440362380563576429474169979957574470056689553339443273887155011*x**17-56445419204725707027320207597461421131436302669719144388680611314203056296491568*x**18+137824979983420484061448003765899263963538802172747565491704051803897069968085471*x**19-319306934415099094865003834648567967406345318313248906802093366250407693056901910*x**20+703741984870396625036467697238773476794062106066462938829372984688611614955299577*x**21-1478998804677298200136559656274075751400137582098603420013144850692604734499362250*x**22+2970254576611696810251116476026981536521937751049474597769097421689232853542637870*x**23-5711164341447634976335829213736640589664416891937794689305647850436123930909911797*x**24+10532154408354105132785028318550571656515488423665117648767699222938308191340510369*x**25-18657787518332323534543941125681126134346370880385921087382959356632265540425886062*x**26+31796741931503732449846334151052424842340933666133732995032757548368511783968742477*x**27-52198868273089107167211872492766023929005166873183276589115174237730559494846998556*x**28+82646613617219615764133947844647849958817966461968461887671047843523967684316883406*x**29-126346204105061326124956055825563643782208285826315699155909655991862609292773395413*x**30+186690668011572477683310770806278065703308977195965104384810452659828837075925744651*x**31-266884072342538429797112472400505835608775029669043945046006069281536879599786025625*x**32+369443671117058290719366342513749692333050415218128598289115821146518071013047792573*x**33-495630069804419638063313976956580068389408424333996264211644905357947848326246793271*x**34+644887809682435402519422950803945219043531837956412573480793474744804029891650910525*x**35-814400900391567733787253198309459537296937397661870372483393082449162951890603167749*x**36+998871222820019782319755189412126038840647256320822090188832173395448840317666573013*x**37-1190607147255221550018666702489855334750344772504578995373077310265354631996342652498*x**38+1379965533986859470448409891997361904646932696462677265400331760931472664604463893735*x**39-1556129371852951106881058006097770037537463792929903626479322808365976623878818617262*x**40+1708137977579152037225769739324831372649286844679532930891389294688613117322388142320*x**41-1826031807324774662440420461303005173973030290395371649553146607772100427171543033783*x**42+1901943035020844293164831555152093645149954699095398598506490448977602051769206568259*x**43-1930964471293848693369584276427088646559146873604759912789544558845714487501383862112*x**44+1911663845506851022520376348128680756712526043019311295851659189555285175342646056993*x**45-1846170725524711409917895476519251492037339868195524645171367644468506707935880281589*x**46+1739836169606081427537496795441653753679038436587073012144030368121831921429252336685*x**47-1600534893656297694134860581062495487622284469814065279675462922955236085894390020331*x**48+1437732182782760559817116017758044625361808445483656704701512384754324831115022162275*x**49-1261463803009059806613181344659158824330292753777758281940532112174051738440847561260*x**50+1081374295175906352456862456270930441647913035469913020741520496091431856168860556494*x**51-905931308780167705582294283612582141099070172607105154544524155370796593819417037662*x**52+741889840555087460714855569673977832218120930839921087273478303153746561781423814349*x**53-594031171901034916621850488963948711463477966457916030770671775020280765874223536223*x**54+465156977543859467129475915653378593093671772890120444728562801184219139293111326691*x**55-356286678611213452611537247869196169205068687714701039252765689191061943179536414275*x**56+266988959803477356603147607100453413111994165873657614610398922971723739151959493818*x**57-195776054949837081033333675271610786542149825816911165758532593579883899934895797421*x**58+140498745803363668623857550566507166593160951015950973444282773653769475220218948414*x**59-98696414349838231147577799564638251913641115371140009023098415772692942330447237375*x**60+67875242866066098317754016222867841081039731396739628716091067925368396374782243105*x**61-45704959618018706231181113771939478671972357539356624022327435256061360649940926548*x**62+30137965889109845352247962964786333064723691439258958392225584527165038828323896748*x**63-19463282358578465622186207615019607959161325694367528775293064518622750256541772888*x**64+12311724161511733869834899577008638195072975876506439067822277312010466841800779239*x**65-7629003311849267842307301692773898075863594531731938218506324220161125055811835744*x**66+4631320607140870792921280584894182654712980734488171521627685108283365888753466681*x**67-2754663778626987171304491621641799311363269175928979453885670575723615545268400343*x**68+1605441051044753853710288368676607360728895558046703100000306656640663703170959160*x**69-916883698222800033584119645361844402803636097525195093628743109284744576567083235*x**70+513165275101797077133313104520184862403175227612112904044611132565868712408976487*x**71-281481178309691410170967089969802686876125788737920122010999410781715273882533018*x**72+151326001414939171331533893624546727264056021978773708292061878062785536636002035*x**73-79738848334167129393560811201074656693169186647190399449576826187894314372880291*x**74+41184693334613093755197867869332988076502432640454252256090488793848471312777150*x**75-20850941506376955608026726892290961344875170624291091581529786049313098595591577*x**76+10347875522662180616730335042856285830252745249709886637548469569926839827443373*x**77-5034095461944262393060907631014013065735322010800836412126145770796973550176835*x**78+2400727049582071825818501866617039573607811089122462437033652397829557483519325*x**79-1122325768856158658457724577438123392565918954479379931123322688515066921009485*x**80+514340825824644780572726933252683088387798003307761524731700867532030074417271*x**81-231066764003449551680215522218131503137325102122433510582943885253564576813641*x**82+101759346733218915560333161677679695512824253129373069679622412914880034295594*x**83-43929355268768464045188685350328438452795986842268128967562934171311980834504*x**84+18589590235788644825819703989621630591675422895994254185318191603939050709653*x**85-7710942767852282950224617396649159381644589141644480901422827377012967371853*x**86+3135114811936162105458806076598677538919983733097060390919999273551649692076*x**87-1249369141625328877422611067306411808264353048195563124532225100253666510546*x**88+487977620126175332845797271330470527911086090570805215026244595535412943721*x**89-186792171678939483231030874463023453347299017701118690924640914555730691984*x**90+70071637658682766073445416044378732499036677185323713658807682231133346042*x**91-25758657093944550317510791588258218541879670474380450714284157185775263773*x**92+9278362679149611980246488949412391232496448634653927821507251510954664124*x**93-3274565874639723097012751599189767499742408121127009775894968368449898367*x**94+1132230056866038237353547020525980798519113233195050489605926329199712042*x**95-383509086930218791295486851015353203901937277261370634415417889329016547*x**96+127243396321621912792776090028559678585223992652421571257769864446579256*x**97-41349389375257468771851544039587605580624687547342141807102864179656264*x**98+13159210384213384815362975810684159207425842540579663753110534123882965*x**99-4100784868970252525075008466989666694501088271228914151075691936481312*x**100+1251200620219271455170797002216664515041781323111025066399023963249170*x**101-373725609078924642667447666205332912113093336421999004119482065908040*x**102+109265863328498157113446573451662212191342638994636284124831650679792*x**103-31264985491414787734140686515545371704450456280778088210777882147752*x**104+8754006158618389975037531907062005172055717301378154179563873583903*x**105-2398056884059469081785701863067504745194831230593284068371781538717*x**106+642601098510741225073730709691439392764768294374321573177229544104*x**107-168412450635579473539807829186721001506350257890835206040519177993*x**108+43159359666486748438657109399649159177696848533462355746818381082*x**109-10813267054949911112946852077335189552696438670579182220631853196*x**110+2648065133073448974613067092678039971355817675224849562928851412*x**111-633715388343369672621287456363849619698596145424430215093533362*x**112+148167500989487807285212567110630649971137124728754987323411574*x**113-33837557869345040258291092256178771133505330302208475376490755*x**114+7546080058082806974314089899582467520444627023580147203685374*x**115-1642871642438583850022447907050767080105337472130010615247980*x**116+349078738746177498147599072467591794467194181687038743444700*x**117-72368962380369247969228380016231827302169297530050353581657*x**118+14633753378844536248267739124640079401582896014760274607618*x**119-2885307325253591607927688451707461449864009747912075883147*x**120+554514365277205595746288398302578646083222481880692202531*x**121-103839312244949158705536631297506865310812474382898492104*x**122+18939784325408139103911955081607167709334491528298141423*x**123-3363411380720994922658140276997043954144227946404504119*x**124+581293184360186919381306277902191017438515680361192342*x**125-97730420232488465329459221703735906639970674598605299*x**126+15976529493182261119281952073618313560855501211538938*x**127-2538290178703277481797164463132253106006850428620648*x**128+391726213364469820069954992525587423547662638126162*x**129-58690863962300110161114856246520435937992748499606*x**130+8532091134290641447554146496909016753831147952010*x**131-1202745756582547381983720815965094098270088531092*x**132+164303309961026525842105728828606642188469994140*x**133-21735866727736854477754737108701953099449970351*x**134+2782605944890834502958275080252422398146796306*x**135-344458427168833513555225619204161637336390890*x**136+41198096151083775568531839804199660313004587*x**137-4756573693770605934001100860443284459256837*x**138+529643984800869899902121978173086947953567*x**139-56821742092303661976030976150135966437710*x**140+5867091097365627813315941527112378509074*x**141-582387347145856916512692468191425848262*x**142+55506916396230109280071995384253944802*x**143-5072844877354486246113574142355178822*x**144+443916895278773588137339990127024670*x**145-37138214144536324005130860443156400*x**146+2965335808886494204427238345713647*x**147-225557509058062064578461097296006*x**148+16311414902030038382518216204987*x**149-1118946945467722795231328393427*x**150+72634363854131503445359704016*x**151-4449416882251311865849431154*x**152+256429514653509365035451347*x**153-13856371727211930831992589*x**154+699303592743763385572544*x**155-32817085610245028639724*x**156+1424782325246907386682*x**157-56892035721330528267*x**158+2074913256887345600*x**159-68549967524058570*x**160+2031075005818309*x**161-53306275395263*x**162+1219950459244*x**163-23849532168*x**164+387234474*x**165-5013176*x**166+48516*x**167-312*x**168+1*x**169,
}

def check(n, q, quiet=True):
    out = os.popen('./grid-col %s %s %s' % ('-q' if quiet else '', n, q), 'r').read().strip()
    assert out.startswith('0x')

    out = int(out[2:], 16)
    golden = CP[n](q)

    if out != golden:
        print 'Difference at n=%d q=%d:' % (n, q)
        print 'Output: %s' % out
        print 'Golden: %s' % golden
        sys.exit(1)

def main():
    if len(sys.argv) == 3:
        n, q = map(int, sys.argv[1:])
        print 'Checking n=%d, q=%d' % (n, q)
        check(n, q, quiet=False)
        print 'OK'
        return

    for n in sorted(CP.keys()):
        if n <= 8:
            print 'Checking n=%d q=2..100' % n
            for q in range(2, 100):
                check(n, q)
        else:
            for q in range(2, 15):
                print 'Checking n=%d, q=%d' % (n, q)
                check(n, q)
    print 'OK'

if __name__ == '__main__':
    main()

